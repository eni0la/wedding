!function(o){if("undefined"==typeof wc_price_based_country_ajax_geo_params)return;var n={xhr:!1,get_product_ids:function(){var a=[],e=null;return o("span.wcpbc-price.loading").each(function(){if(void 0===(e=o(this).data("productId"))){var r=o(this).attr("class").match(/wcpbc-price-\d+/);null!=r&&0<r.length&&(e=parseInt(r[0].replace("wcpbc-price-","")))}e&&void 0!==e&&a.push(e)}),0<o(".variations_form").length&&o(".variations_form").each(function(){var r=o(this).data("product_variations");null!=r&&o.each(r,function(r,e){void 0!==e.variation_id&&a.push(e.variation_id)})}),o(document.body).trigger("wc_price_based_country_get_product_ids",[a]),a.sort(),a},get_areas:function(){var t={};return o(".wc-price-based-country-refresh-area:not(.refreshed)").each(function(r,e){var a=o(e).data("area"),i=o(e).data("id"),c=o(e).data("options");void 0!==a&&void 0!==i&&void 0!==c&&(void 0===t[a]&&(t[a]={}),t[a][i]=c)}),t},refresh_product_price:function(t){var a;o.each(t,function(r,e){void 0!==(a=o("<div>"+e.price_html+"</div>").find(".wcpbc-price.wcpbc-price-"+e.id+":first"))&&o(".wcpbc-price.wcpbc-price-"+e.id).html(a.html()).removeClass("loading")}),0<o(".variations_form").length&&o(".variations_form").each(function(){var i=o(this).data("product_variations"),c=o(this);null!=i&&(o.each(i,function(r,e){if(void 0!==t[e.variation_id]){var a=o(e.price_html);i[r].display_price=t[e.variation_id].display_price,i[r].display_regular_price=t[e.variation_id].display_regular_price,0<a.length?a.hasClass("price")?a.first().html(t[e.variation_id].price_html):a=o(t[e.variation_id].price_html):o("body").hasClass("single-product")||(a=n.compatibility.variation_price_html(a,c,t[e.variation_id].price_html)),0<a.length&&(a.find(".wcpbc-price").css("visibility",""),a.find(".wcpbc-price").removeClass("loading"),a=o("<div></div>").append(a),i[r].price_html=a.html())}}),o(this).data("product_variations",i))}),o(document.body).trigger("wc_price_based_country_set_product_price",[t]),o(".wcpbc-price").css("visibility",""),o(".wcpbc-price").css("display",""),o(".wcpbc-price").removeClass("loading")},refresh_areas:function(r){o.each(r,function(r,e){var a='.wc-price-based-country-refresh-area[data-id="'+e.id+'"][data-area="'+e.area+'"]',i=o(e.content).filter('.wc-price-based-country-refresh-area[data-area="'+e.area+'"]').html();o(a).html(i).addClass("refreshed")}),o(document.body).trigger("wc_price_based_country_refresh_areas",[r])},refresh_currency_settings:function(r){if("undefined"!=typeof woocommerce_price_slider_params&&"undefined"!=typeof accounting){var e=o(".price_slider_amount #min_price").data("min"),a=o(".price_slider_amount #max_price").data("max");o(".price_slider_amount span.from").html(accounting.formatMoney(e,{symbol:r.symbol,decimal:r.decimal_sep,thousand:r.thousand_sep,precision:woocommerce_price_slider_params.currency_format_num_decimals,format:r.format})),o(".price_slider_amount span.to").html(accounting.formatMoney(a,{symbol:r.symbol,decimal:r.decimal_sep,thousand:r.thousand_sep,precision:woocommerce_price_slider_params.currency_format_num_decimals,format:r.format})),woocommerce_price_slider_params.currency_format_symbol=r.symbol,woocommerce_price_slider_params.currency_format_decimal_sep=r.decimal_sep,woocommerce_price_slider_params.currency_format_thousand_sep=r.thousand_sep,woocommerce_price_slider_params.currency_format=r.format}o(document.body).trigger("wc_price_based_country_set_currency_params",[r])},compatibility:{variation_price_html:function(r,e,a){return r.length<=0&&e.hasClass("wvs-archive-variation-wrapper")&&(r=o("<span></span>").append(a)),r},bind:function(){0<o(".shop-container .products").length&&o(".shop-container .products").on("append.infiniteScroll",n.geolocate_customer),0<o(".wc-price-based-country-refresh-area .wcsatt-options-wrapper").length&&o(document.body).on("wc_price_based_country_refresh_areas",function(){o(".product form.cart").each(function(){o(this).data("satt_script",null)}),o(document.body).triggerHandler("wcsatt-initialize")}),0<o(".variations_form.cart").length&&0<o('[class^="wcsatt"]').length&&o(document.body).on("wc_price_based_country_set_product_price",function(){0<o(".variations_form.cart .wcsatt-options-wrapper").length&&o(".variations_form.cart .variations select").trigger("change.wc-variation-form")})}},geolocate_customer:function(){n.xhr&&n.xhr.abort();var r={ids:n.get_product_ids(),areas:n.get_areas(),is_single:o("body").hasClass("single")?"1":"0"};0===r.ids.length&&o.isEmptyObject(r.areas)&&0===o(".wcpbc-content:not(.refreshed)").length||(n.xhr=o.ajax({url:wc_price_based_country_ajax_geo_params.wc_ajax_url.toString().replace("%%endpoint%%","wcpbc_get_location"),data:r,type:"POST",success:function(r){n.refresh_product_price(r.products),n.refresh_areas(r.areas),n.refresh_currency_settings(r.currency_params),o(document.body).trigger("wc_price_based_country_after_ajax_geolocation",[r.zone_id])},error:function(){o(".wcpbc-price").css("visibility",""),o(".wcpbc-price").css("display",""),o(".wcpbc-price").removeClass("loading")},complete:function(){n.xhr=!1}}))},init:function(){this.geolocate_customer(),o(document).ajaxComplete(function(r,e,a){0==o("body").find(".wcpbc-price.loading").length||0<a.url.indexOf("wcpbc_get_location")||0<a.url.indexOf("get_refreshed_fragments")||void 0!==e.responseText&&0<e.responseText.indexOf("wcpbc-price")&&n.geolocate_customer()}),o(document.body).on("wc_price_based_country_ajax_geolocation",n.geolocate_customer),this.compatibility.bind()}};n.init()}(jQuery);